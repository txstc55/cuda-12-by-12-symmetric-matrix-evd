import numpy as np

originalMatrix = [0.213122, 0.000000, -0.000000, -0.213122, -0.000000, 0.000000, 0.000029, 0.096662, -0.000000, -0.000029, -0.096662, 0.000000, 
0.000000, 0.369094, -0.000000, -0.000000, -0.369094, 0.059331, 0.059331, 0.000029, -0.059331, -0.059330, -0.000029, -0.000000, 
-0.000000, -0.000000, 0.213122, 0.000000, 0.096663, -0.213122, -0.000000, -0.096662, 0.000029, 0.000000, -0.000000, -0.000029, 
-0.213122, -0.000000, 0.000000, 0.426245, 0.000000, -0.000000, 0.000000, -0.096662, 0.096675, -0.213122, 0.096662, -0.096675, 
-0.000000, -0.369094, 0.096663, 0.000000, 0.582217, -0.155993, -0.059331, 0.000000, 0.059331, 0.059331, -0.213123, 0.000000, 
0.000000, 0.059331, -0.213122, -0.000000, -0.155993, 0.582259, 0.059339, 0.096662, -0.156014, -0.059338, 0.000000, -0.213123, 
0.000029, 0.059331, -0.000000, 0.000000, -0.059331, 0.059339, 0.369079, 0.000000, -0.156014, -0.369108, -0.000000, 0.096675, 
0.096662, 0.000029, -0.096662, -0.096662, 0.000000, 0.096662, 0.000000, 0.213065, -0.000000, -0.000000, -0.213094, 0.000000, 
-0.000000, -0.059331, 0.000029, 0.096675, 0.059331, -0.156014, -0.156014, -0.000000, 0.369079, 0.059338, 0.000000, -0.213094, 
-0.000029, -0.059330, 0.000000, -0.213122, 0.059331, -0.059338, -0.369108, -0.000000, 0.059338, 0.582259, 0.000000, 0.000000, 
-0.096662, -0.000029, -0.000000, 0.096662, -0.213123, 0.000000, -0.000000, -0.213094, 0.000000, 0.000000, 0.426245, 0.000000, 
0.000000, -0.000000, -0.000029, -0.096675, 0.000000, -0.213123, 0.096675, 0.000000, -0.213094, 0.000000, 0.000000, 0.426245, ]
originalMatrix = np.array(originalMatrix).reshape(12,12)

oursEigenVectors = [0.428926, 0.122849, -0.000000, 0.052059, 0.279296, 0.247684, 0.151817, 0.557446, 0.273976, 0.000000, 0.047023, 0.158916, 
-0.244874, -0.351586, -0.064842, -0.358607, -0.030671, 0.419248, 0.179812, -0.110547, 0.389548, -0.064842, -0.096723, 0.311660, 
0.184293, -0.615557, 0.495778, 0.142456, -0.042828, 0.146096, -0.211910, 0.203725, -0.423200, 0.495778, 0.488297, 0.357230, 
-0.505069, 0.024206, -0.000000, -0.141463, -0.455320, -0.031101, -0.352375, 0.301544, -0.034245, 0.000000, 0.047023, 0.158916, 
0.006455, -0.179434, -0.064842, 0.536881, 0.180016, -0.237680, -0.317182, -0.075204, 0.324442, -0.064842, -0.096723, 0.311660, 
0.005236, -0.121232, 0.495777, -0.386885, 0.069757, -0.395870, 0.411541, 0.031182, 0.109449, 0.495778, 0.488297, 0.357230, 
0.239434, -0.019418, -0.000000, -0.343599, 0.301700, -0.004316, -0.350156, -0.583919, -0.135305, 0.000000, 0.047023, 0.158916, 
-0.204921, 0.314825, -0.064842, 0.007611, 0.292586, 0.223775, 0.185392, 0.096380, -0.623458, -0.064842, -0.096723, 0.311660, 
0.156667, 0.390207, 0.495778, 0.223282, -0.391974, 0.468921, 0.007599, -0.313005, 0.143667, 0.495778, 0.488297, 0.357230, 
-0.163292, -0.127637, 0.000000, 0.433002, -0.125676, -0.212268, 0.550715, -0.275071, -0.104426, 0.000000, 0.047023, 0.158916, 
0.443340, 0.216195, -0.064842, -0.185885, -0.441932, -0.405343, -0.048021, 0.089372, -0.090531, -0.064842, -0.096723, 0.311660, 
-0.346195, 0.346583, 0.495778, 0.021146, 0.365046, -0.219147, -0.207230, 0.078098, 0.170084, 0.495778, 0.488297, 0.357230, ]
oursEigenVectors = np.array(oursEigenVectors).reshape(12,12)

ourEigenValues = [0.318013, 0.248762, 0.746981, 1.151098, 0.814818, 0.485430, 0.856237, 0.099036, 0.051735, -0.000078, -0.000000, -0.000000]


ourEigenValues = np.array(ourEigenValues)
ourEigenValues = np.diag(ourEigenValues)

print("Norm of difference for ours:")
print(np.linalg.norm(originalMatrix - oursEigenVectors @ ourEigenValues @ oursEigenVectors.T))
print("Orthogonality of eigenvectors for ours:")
print(np.linalg.norm(np.eye(12) - oursEigenVectors @ oursEigenVectors.T))


cusolverEigenVectors = [-0.175293, 0.249286, 0.396394, -0.273977, -0.557447, -0.122849, -0.428926, 0.247684, -0.003071, -0.279297, -0.151815, -0.052059, 
0.410693, -0.121486, 0.258018, -0.389546, 0.110547, 0.351588, 0.244876, 0.419248, 0.254586, 0.030669, -0.179811, 0.358607, 
-0.224956, -0.416049, 0.162167, 0.423200, -0.203727, 0.615558, -0.184291, 0.146096, 0.167763, 0.042829, 0.211910, -0.142456, 
-0.175295, 0.249286, 0.396393, 0.034243, -0.301544, -0.024207, 0.505070, -0.031102, -0.223056, 0.455322, 0.352373, 0.141462, 
0.410693, -0.121486, 0.258019, -0.324439, 0.075204, 0.179434, -0.006455, -0.237681, -0.359306, -0.180015, 0.317182, -0.536881, 
-0.224953, -0.416050, 0.162167, -0.109449, -0.031182, 0.121231, -0.005236, -0.395870, -0.491629, -0.069757, -0.411541, 0.386885, 
-0.175297, 0.249289, 0.396394, 0.135303, 0.583918, 0.019421, -0.239434, -0.004316, -0.036258, -0.301698, 0.350157, 0.343599, 
0.410688, -0.121485, 0.258020, 0.623460, -0.096378, -0.314826, 0.204921, 0.223776, -0.201973, -0.292587, -0.185390, -0.007611, 
-0.224954, -0.416049, 0.162170, -0.143668, 0.313006, -0.390204, -0.156668, 0.468922, -0.176460, 0.391974, -0.007601, -0.223283, 
-0.175297, 0.249288, 0.396393, 0.104424, 0.275070, 0.127638, 0.163292, -0.212267, 0.262385, 0.125673, -0.550716, -0.433002, 
0.410691, -0.121486, 0.258020, 0.090533, -0.089370, -0.216192, -0.443340, -0.405342, 0.306693, 0.441932, 0.048019, 0.185885, 
-0.224953, -0.416051, 0.162169, -0.170085, -0.078096, -0.346583, 0.346193, -0.219148, 0.500325, -0.365046, 0.207232, -0.021146,]
cusolverEigenVectors = np.array(cusolverEigenVectors).reshape(12,12)
cusolverEigenValues = [-0.000001, -0.000000, 0.000000, 0.051734, 0.099035, 0.248761, 0.318014, 0.485430, 0.746904, 0.814817, 0.856237, 1.151098, ]
cusolverEigenValues = np.array(cusolverEigenValues)
cusolverEigenValues = np.diag(cusolverEigenValues)

print("Norm of difference for cusolver:")
print(np.linalg.norm(originalMatrix - cusolverEigenVectors @ cusolverEigenValues @ cusolverEigenVectors.T))
print("Orthogonality of eigenvectors for cusolver:")
print(np.linalg.norm(np.eye(12) - cusolverEigenVectors @ cusolverEigenVectors.T))


U = [1.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, 0.000000, 
0.000000, 0.000000, 0.000136, 0.479317, -0.055749, -0.381791, -0.493064, -0.252190, 0.071258, -0.244196, -0.499962, -0.000003, 
0.000000, 0.000000, -0.140300, -0.102897, 0.180300, -0.167089, 0.119206, 0.111316, 0.788110, -0.107624, -0.000010, -0.500000, 
0.000000, 0.841728, 0.216325, 0.144891, 0.022530, -0.280439, 0.091237, 0.294665, -0.032580, 0.219856, -0.000031, -0.000000, 
0.000000, 0.000000, 0.309285, -0.397482, 0.180433, -0.112283, 0.268511, -0.500643, 0.017050, 0.357941, -0.500032, -0.000003, 
0.000000, 0.000000, 0.140351, 0.195428, -0.465359, 0.383295, -0.250515, -0.093714, 0.041154, 0.505373, -0.000053, -0.500000, 
0.000000, -0.000115, 0.000068, 0.687732, 0.393964, 0.335736, 0.461675, -0.209508, 0.034625, 0.029354, -0.000006, 0.000000, 
0.000000, -0.381768, 0.083871, 0.118695, -0.037507, -0.062120, 0.212723, 0.701293, -0.080090, 0.185341, -0.500037, -0.000005, 
0.000000, 0.000000, -0.309470, -0.082937, 0.568050, -0.089781, -0.243974, 0.054474, -0.483385, 0.143027, 0.000002, -0.500000, 
0.000000, 0.000115, 0.681866, -0.090788, 0.384426, 0.371730, -0.374972, 0.176738, 0.098917, -0.243362, 0.000023, -0.000000, 
0.000000, 0.381768, -0.393290, -0.200530, -0.087180, 0.556186, 0.011812, 0.051494, -0.008277, -0.299320, -0.499968, -0.000004, 
0.000000, 0.000000, 0.309419, -0.009593, -0.282989, -0.126425, 0.375282, -0.072080, -0.345878, -0.540775, 0.000077, -0.500001, ]
U = np.array(U).reshape((12, 12))

H = [0.213122, -0.253196, -0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 
-0.253196, 0.581496, -0.263026, -0.000000, -0.000000, 0.000000, -0.000000, -0.000000, -0.000000, -0.000000, -0.000000, 0.000000, 
-0.000000, -0.263026, 0.466874, -0.266874, 0.000000, 0.000000, 0.000000, -0.000000, 0.000000, 0.000000, 0.000000, -0.000000, 
-0.000000, -0.000000, -0.266874, 0.759123, -0.403813, 0.000000, 0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.000000, 
0.000000, -0.000000, 0.000000, -0.403813, 0.474710, -0.188847, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, 
0.000000, 0.000000, 0.000000, 0.000000, -0.188847, 0.418003, -0.153130, -0.000000, 0.000000, 0.000000, -0.000000, 0.000000, 
0.000000, -0.000000, 0.000000, 0.000000, -0.000000, -0.153130, 0.706622, -0.230420, -0.000000, -0.000000, -0.000000, -0.000000, 
0.000000, -0.000000, -0.000000, -0.000000, 0.000000, -0.000000, -0.230420, 0.188857, -0.083792, 0.000000, 0.000000, -0.000000, 
-0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, -0.083792, 0.219857, -0.043059, -0.000000, 0.000000, 
0.000000, -0.000000, 0.000000, 0.000000, 0.000000, 0.000000, -0.000000, 0.000000, -0.043059, 0.743367, -0.000086, -0.000000, 
0.000000, -0.000000, 0.000000, -0.000000, 0.000000, -0.000000, -0.000000, 0.000000, -0.000000, -0.000086, -0.000000, 0.000000, 
0.000000, 0.000000, -0.000000, -0.000000, -0.000000, 0.000000, -0.000000, -0.000000, 0.000000, -0.000000, 0.000000, -0.000000,]
H = np.array(H).reshape((12, 12))
print(np.linalg.norm(U @ H @ U.T - originalMatrix))